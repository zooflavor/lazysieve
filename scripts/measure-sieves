#!/bin/bash
DB=../db
MEASURES=3
SAMPLES=10000

function measure {
	SIEVE="$1"
	START="$2"
	END="$3"
	SEGMENT_SIZE="$4"
	DIR0="$5"
	FILE="$6"
	DIR1="../samples/segments-nanosecs/${DIR0}"
	DIR2="../samples/segments-operations/${DIR0}"
	DIR3="../samples/sum-nanosecs/${DIR0}"
	DIR4="../samples/sum-operations/${DIR0}"
	FILE1="${DIR1}/${FILE}.csv"
	FILE2="${DIR2}/${FILE}.csv"
	FILE3="${DIR3}/${FILE}.csv"
	FILE4="${DIR4}/${FILE}.csv"
	mkdir -p "${DIR1}"
	mkdir -p "${DIR2}"
	mkdir -p "${DIR3}"
	mkdir -p "${DIR4}"
	echo "$DIR" "$FILE"
	java -Xms3584m -Xmx3584m -jar ../gui/dist/gui.jar measure sieve "${DB}" \
		"${SIEVE}" "${START}" "${END}" "${SEGMENT_SIZE}" "${MEASURES}" \
		"${SAMPLES}" "${FILE1}" "${FILE2}" "${FILE3}" "${FILE4}"
	if [ "0" != "$?" ]; then
		exit 1
	fi
}

DIR="speed1"
START3="0x1"
END3="0x800000001"
measure atkin "$START3" "$END3" "0x100000" "${DIR}" "atkin"
measure bin-heap "$START3" "$END3" "0x100000" "${DIR}" "bin-heap"
measure bin-heap-inplace "$START3" "$END3" "0x100000" "${DIR}" "bin-heap-inplace"
measure buckets "$START3" "$END3" "0x100000" "${DIR}" "buckets"
measure buckets-1 "$START3" "$END3" "0x100000" "${DIR}" "buckets-1"
measure buckets-2 "$START3" "$END3" "0x100000" "${DIR}" "buckets-2"
measure buckets-3 "$START3" "$END3" "0x100000" "${DIR}" "buckets-3"
measure buckets-4 "$START3" "$END3" "0x100000" "${DIR}" "buckets-4"
measure buckets-5 "$START3" "$END3" "0x100000" "${DIR}" "buckets-5"
measure buckets-6 "$START3" "$END3" "0x100000" "${DIR}" "buckets-6"
measure buckets-7 "$START3" "$END3" "0x100000" "${DIR}" "buckets-7"
measure buckets-8 "$START3" "$END3" "0x100000" "${DIR}" "buckets-8"
measure buckets-simple "$START3" "$END3" "0x100000" "${DIR}" "buckets-simple"
measure cols "$START3" "$END3" "0x100000" "${DIR}" "cols"
measure eratosthenes-segmented "$START3" "$END3" "0x100000" "${DIR}" "eratosthenes-segmented"

DIR="speed36"
START3="0x1000000001"
END3="0x1200000001"
measure bin-heap "$START3" "$END3" "0x100000" "${DIR}" "bin-heap"
measure bin-heap-inplace "$START3" "$END3" "0x100000" "${DIR}" "bin-heap-inplace"
measure buckets "$START3" "$END3" "0x100000" "${DIR}" "buckets"
measure buckets-1 "$START3" "$END3" "0x100000" "${DIR}" "buckets-1"
measure buckets-2 "$START3" "$END3" "0x100000" "${DIR}" "buckets-2"
measure buckets-3 "$START3" "$END3" "0x100000" "${DIR}" "buckets-3"
measure buckets-4 "$START3" "$END3" "0x100000" "${DIR}" "buckets-4"
measure buckets-5 "$START3" "$END3" "0x100000" "${DIR}" "buckets-5"
measure buckets-6 "$START3" "$END3" "0x100000" "${DIR}" "buckets-6"
measure buckets-7 "$START3" "$END3" "0x100000" "${DIR}" "buckets-7"
measure buckets-8 "$START3" "$END3" "0x100000" "${DIR}" "buckets-8"
measure cols "$START3" "$END3" "0x100000" "${DIR}" "cols"
measure eratosthenes-segmented "$START3" "$END3" "0x100000" "${DIR}" "eratosthenes-segmented"

DIR="speed40"
START3="0x10000000001"
END3="0x10200000001"
measure bin-heap "$START3" "$END3" "0x100000" "${DIR}" "bin-heap"
measure bin-heap-inplace "$START3" "$END3" "0x100000" "${DIR}" "bin-heap-inplace"
measure buckets "$START3" "$END3" "0x100000" "${DIR}" "buckets"
measure buckets-1 "$START3" "$END3" "0x100000" "${DIR}" "buckets-1"
measure buckets-2 "$START3" "$END3" "0x100000" "${DIR}" "buckets-2"
measure buckets-3 "$START3" "$END3" "0x100000" "${DIR}" "buckets-3"
measure buckets-4 "$START3" "$END3" "0x100000" "${DIR}" "buckets-4"
measure buckets-5 "$START3" "$END3" "0x100000" "${DIR}" "buckets-5"
measure buckets-6 "$START3" "$END3" "0x100000" "${DIR}" "buckets-6"
measure buckets-7 "$START3" "$END3" "0x100000" "${DIR}" "buckets-7"
measure buckets-8 "$START3" "$END3" "0x100000" "${DIR}" "buckets-8"
measure cols "$START3" "$END3" "0x100000" "${DIR}" "cols"
measure eratosthenes-segmented "$START3" "$END3" "0x100000" "${DIR}" "eratosthenes-segmented"

DIR="speed44"
START3="0x100000000001"
END3="0x100200000001"
measure buckets-8 "$START3" "$END3" "0x100000" "${DIR}" "buckets-8"
measure cols "$START3" "$END3" "0x100000" "${DIR}" "cols"
measure eratosthenes-segmented "$START3" "$END3" "0x100000" "${DIR}" "eratosthenes-segmented"

DIR="speed48"
START3="0x1000000000001"
END3="0x1000200000001"
measure buckets-8 "$START3" "$END3" "0x100000" "${DIR}" "buckets-8"
measure cols "$START3" "$END3" "0x100000" "${DIR}" "cols"
measure eratosthenes-segmented "$START3" "$END3" "0x100000" "${DIR}" "eratosthenes-segmented"

DIR="speed52"
START3="0x10000000000001"
END3="0x10000200000001"
measure buckets-8 "$START3" "$END3" "0x100000" "${DIR}" "buckets-8"
measure cols "$START3" "$END3" "0x100000" "${DIR}" "cols"

DIR="speed56"
START3="0x100000000000001"
END3="0x100000200000001"
measure buckets-8 "$START3" "$END3" "0x100000" "${DIR}" "buckets-8"
measure cols "$START3" "$END3" "0x100000" "${DIR}" "cols"

DIR="speed60"
START3="0x1000000000000001"
END3="0x1000000200000001"
measure buckets-8 "$START3" "$END3" "0x100000" "${DIR}" "buckets-8"
measure cols "$START3" "$END3" "0x100000" "${DIR}" "cols"

DIR="speed63"
START3="0x8000000000000001"
END3="0x8000000200000001"
measure buckets-8 "$START3" "$END3" "0x100000" "${DIR}" "buckets-8"
measure cols "$START3" "$END3" "0x100000" "${DIR}" "cols"

DIR="speed64"
START3="0xffffff0000000001"
END3="0xffffff0200000001"
measure buckets-8 "$START3" "$END3" "0x100000" "${DIR}" "buckets-8"
measure cols "$START3" "$END3" "0x100000" "${DIR}" "cols"

DIR="atkin"
START3="0x1"
END3="0x100000001"
measure atkin "$START3" "$END3" "0x10000" "${DIR}" "segment-size-16"
measure atkin "$START3" "$END3" "0x20000" "${DIR}" "segment-size-17"
measure atkin "$START3" "$END3" "0x40000" "${DIR}" "segment-size-18"
measure atkin "$START3" "$END3" "0x80000" "${DIR}" "segment-size-19"
measure atkin "$START3" "$END3" "0x100000" "${DIR}" "segment-size-20"
measure atkin "$START3" "$END3" "0x200000" "${DIR}" "segment-size-21"
measure atkin "$START3" "$END3" "0x400000" "${DIR}" "segment-size-22"
measure atkin "$START3" "$END3" "0x800000" "${DIR}" "segment-size-23"
measure atkin "$START3" "$END3" "0x2000000" "${DIR}" "segment-size-25"
measure atkin "$START3" "$END3" "0x4000000" "${DIR}" "segment-size-26"
measure atkin "$START3" "$END3" "0x8000000" "${DIR}" "segment-size-27"
measure atkin "$START3" "$END3" "0x10000000" "${DIR}" "segment-size-28"
measure atkin "$START3" "$END3" "0x20000000" "${DIR}" "segment-size-29"
measure atkin "$START3" "$END3" "0x40000000" "${DIR}" "segment-size-30"
END3="0x2000000001"
measure atkin "$START3" "$END3" "0x1000000" "${DIR}" "segment-size-24"

exit 0
